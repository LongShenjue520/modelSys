function Merger(r,a,e){for(var t=$("#"+r).getDataIDs(),i=t.length,o=0;i>o;o++){var d=$("#"+r).jqGrid("getRowData",t[o]),n=1;for(j=o+1;j<=i;j++){var l=$("#"+r).jqGrid("getRowData",t[j]);if(d[a]!=l[a]||d[e]!=l[e]){n=1;break}n++,$("#"+r).setCell(t[j],a,"",{display:"none"}),$("#"+r).setCell(t[o],a,"","",{rowspan:n})}}}function show_doSearch(r,a,e){var t="";if($("#"+r+" :input").each(function(){var r=$(this).attr("name"),a=$(this).val();""!=a&&(t=""==t?"/"+r+"/"+a:t+"/"+r+"/"+a)}),0!=e&&""==t)return alert("请填写检索条件"),!1;var i=a+t;window.open(i)}function lookupfunc_exportExcel(r,a,e,t,i){var o=$("#"+a).jqGrid("getGridParam","sortname"),d=$("#"+a).jqGrid("getGridParam","sortorder"),n=$("#"+a).jqGrid("getGridParam","rowNum"),l=$("#"+a).jqGrid("getGridParam","page"),s=r+"/ReportExcel/index/reporttype/"+e+i+"?sidx="+o+"&sord="+d+"&rows="+n+"&page="+l+"&gettype="+t;window.open(s)}function lookupfunc_exportExcelPdf(r,a,e){var t=navTab.getCurrentPanel(),i=$("#"+r).jqGrid("getGridParam","sortname"),o=$("#"+r).jqGrid("getGridParam","sortorder"),d=$("#"+r).jqGrid("getGridParam","rowNum"),n=$("#"+r).jqGrid("getGridParam","page"),l=t.find("input[name='collhandledate']").val(),s=t.find("input[name='overdate']").val();s||(s=-1);var p=TP_APP+"/ReportExcel/index/reporttype/"+a+"/collhandledate/"+l+"/overdate/"+s+"?sidx="+i+"&sord="+o+"&rows="+d+"&page="+n+"&gettype="+e;window.open(p)}function lookupfunc_exportcontrolExcel(r,a,e,t,i,o){var d=navTab.getCurrentPanel(),n=d.find("input[name='"+i+"']").val();if(""==n)return alert("请选择要汇总的月份"),!1;if(d.find("#"+o).find("input[type='checkbox']:checked").length<1)return alertMsg.error("请选择需要显示的字段！"),!1;var l="",s="";d.find("#"+o).find("input[type='checkbox']:checked").each(function(){l+=$(this).val()+",",s+=$(this).attr("rel")+","});var p=$("#"+a).jqGrid("getGridParam","sortname"),g=$("#"+a).jqGrid("getGridParam","sortorder"),f=$("#"+a).jqGrid("getGridParam","rowNum"),G=$("#"+a).jqGrid("getGridParam","page"),c=r+"/ReportExcel/index/reporttype/"+e+"/collhandledate/"+n+"/discolname/"+l+"?sidx="+p+"&sord="+g+"&rows="+f+"&page="+G+"&gettype="+t;window.open(c)}function reportReloadGrid_doSearch(r,a,e,t,i,o,d,n){var l=navTab.getCurrentPanel(),s=l.find("input[name='"+r+"']").val(),p=l.find("input[name='overdate']").val();return p||(p=-1),""==s?(alert("请选择要汇总的月份"),!1):void l.find("#"+a).jqGrid("setGridParam",{url:e,datatype:"json",postData:{collhandledate:s,listtype:1,overdate:p},page:1}).trigger("reloadGrid")}function cellColor(r,a,e){var t=$("#"+r).getDataIDs(),i=t.length,o=new Array;o[1]="#ecf1f2",o[2]="#ffffa4";var d=new Array;if(d[0]=1,task=1,"task"==e){o[1]="ui-state-colorbad",o[2]="";for(var n=1;i>=n;n++){var l=$("#"+a+t[n-1]).text();"0"==l&&(task=1==task?0:1),0==task?d[n-1]=1:d[n-1]=2}}else for(var n=1;i>n;n++){var l=$("#"+a+t[n-1]).attr("title"),s=$("#"+a+t[n]).attr("title");s==l?d[n]=d[n-1]:1==d[n-1]?d[n]=2:2==d[n-1]&&(d[n]=1)}for(var n=0;i>n;n++)"task"==e?$("#"+t[n]).addClass(o[d[n]]):$("#"+t[n]).css("background",o[d[n]])}function fontColor(r,a){for(var e=$("#"+r).getDataIDs(),t=e.length,i=0;t>i;i++){var o=$("#"+a+e[i]).attr("title");$("#"+e[i]).css("color",o)}}function reportJqGridDoSearch(r,a,e){var t=r.form,i=$(t).serializeArray(),o=$("#"+a).jqGrid("getGridParam","sortname"),d=$("#"+a).jqGrid("getGridParam","sortorder"),n=$("#"+a).jqGrid("getGridParam","rowNum"),l=$("#"+a).jqGrid("getGridParam","page");i=$.extend({sidx:o,sord:d,rows:n,page:l},i),$("#"+a).jqGrid("setGridParam",{url:e,datatype:"json",postData:i}).trigger("reloadGrid")}function exportJqGridDoSearch(r,a,e,t){var i=r.form,o=$("#"+a).jqGrid("getGridParam","sortname"),d=$("#"+a).jqGrid("getGridParam","sortorder"),n=$("#"+a).jqGrid("getGridParam","rowNum"),l=$("#"+a).jqGrid("getGridParam","page");$(i).attr("action",e),$(i).find("input[name='sidx']").val(o),$(i).find("input[name='sord']").val(d),$(i).find("input[name='rows']").val(n),$(i).find("input[name='page']").val(l),$(i).find("input[name='exportType']").val(t),i.submit()}