jQuery.fn.fancyZoom=function(t){function o(o){if(n)return!1;n=!0;var i=$($(this).attr("href")),s=t.width,l=t.height,a=window.innerWidth||window.document.documentElement.clientWidth||window.document.body.clientWidth,h=window.innerHeight||window.document.documentElement.clientHeight||window.document.body.clientHeight,r=window.pageXOffset||window.document.documentElement.scrollLeft||window.document.body.scrollLeft,m=window.pageYOffset||window.document.documentElement.scrollTop||window.document.body.scrollTop,u={width:a,height:h,x:r,y:m},a=(s||i.width())+40,h=(l||i.height())+40,p=u,w=Math.max(p.height/2-h/2+m,0),f=p.width/2-a/2,g=o.pageY,_=o.pageX;return d.attr("curTop",g),d.attr("curLeft",_),d.attr("scaleImg",t.scaleImg?"true":"false"),$("#zoom").hide().css({position:"absolute",top:g+"px",left:_+"px",width:"1px",height:"1px"}),d.hide(),t.closeOnClick&&$("#zoom").click(e),t.scaleImg?(c.html(i.html()),$("#zoom_content img").css("width","100%")):c.html(""),$("#zoom").animate({top:w+"px",left:f+"px",opacity:"show",width:a,height:h},500,null,function(){1!=t.scaleImg&&c.html(i.html()),d.show(),n=!1}),!1}function e(){return n?!1:(n=!0,$("#zoom").unbind("click"),"true"!=d.attr("scaleImg")&&c.html(""),d.hide(),$("#zoom").animate({top:d.attr("curTop")+"px",left:d.attr("curLeft")+"px",opacity:"hide",width:"1px",height:"1px"},500,null,function(){"true"==d.attr("scaleImg")&&c.html(""),n=!1}),!1)}var t=t||{},n=(t&&t.directory?t.directory:"images",!1);if(0==$("#zoom").length){var i='<div class="round_shade_box" id="zoom"> 					<div class="round_shade_top"> 						<span class="round_shade_topleft"> </span> 						<span class="round_shade_topright"> </span> 					</div> 					<div class="round_shade_centerleft"> 						<div class="round_shade_centerright"> 							<div class="round_shade_center" id="zoom_content"> </div> 						</div> 					</div> 					<div class="round_shade_bottom"> 						<span class="round_shade_bottomleft"> </span> 						<span class="round_shade_bottomright"> </span> 					</div> 					<a href="#close" class="round_box_close" id="zoom_close">关闭</a> 				</div>';$("body").append(i),$("html").click(function(t){0==$(t.target).parents("#zoom:visible").length&&e()}),$(document).keyup(function(t){27==t.keyCode&&$("#zoom:visible").length>0&&e()}),$("#zoom_close").click(e)}var d=($("#zoom"),$("#zoom_close")),c=$("#zoom_content");return this.each(function(t){$($(this).attr("href")).hide(),$(this).click(o)}),$("#zoom_close").click(e),this};