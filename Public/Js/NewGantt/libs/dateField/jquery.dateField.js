jQuery.fn.dateField=function(e){if(!e.inputField)return console.error("You must supply an input field"),!1;if("undefined"==typeof e.firstDayOfWeek&&(e.firstDayOfWeek=Date.firstDayOfWeek),"undefined"==typeof e.useWheel&&(e.useWheel=!0),"undefined"==typeof e.dateFormat&&(e.dateFormat=Date.defaultFormat),!e.inputField.is("[readonly]")&&!e.inputField.is("[disabled]")){var t={currentDate:new Date};t.options=e;var a=this.eq(0),n=$("<div>").addClass("calBox"),s=$("<div>").addClass("calNavBar"),r=$("<div>").addClass("calDay");if(r.addClass("calFullMonth"),n.append(s).append(r),e.isSearchField){var i=$("<div>").addClass("shortCuts").html("<span title='last quarter'>LQ</span> <span title='last month'>LM</span> <span title='this month'>M</span> <span title='last week'>LW</span> <span title='this week'>W</span> <span title='yesterday'>Y</span> <span title='today'>T</span><span title='tomorrow'>TO</span> <span title='next week'>NW</span> <span title='next month'>NM</span> <span title='this quarter'>Q</span> <span title='next quarter'>NQ</span>");i.click(function(t){var a=$(t.target);a.is("span")&&(e.isSearchField?e.inputField.val(a.text().trim()):e.inputField.val(Date.parseString(a.text().trim(),e.dateFormat).format(e.dateFormat),!0),n.remove())}),n.append(i)}$("body").append(n),nearBestPosition(a,n),n.bringToFront(),$("body").oneTime(100,"regclibodcal",function(){$("body").bind("click.dateField",function(){$(this).unbind("click.dateField"),n.remove()})}),t.drawCalendar=function(a){t.currentDate=a;var i=function(e){var t=new Date(e.getTime());s.empty(),t.setMonth(t.getMonth()-1);var a=$("<span>").addClass("calElement noCallback prev").attr("millis",t.getTime());t.setMonth(t.getMonth()+1);var n=$("<span>").html(t.format("MMMM yyyy"));t.setMonth(t.getMonth()+1);var r=$("<span>").addClass("calElement noCallback next").attr("millis",t.getTime());s.append(a).append(n).append(r)},l=function(t){r.empty();var a=new Date,s=parseInt((n.width()-4-28)/7)+"px",i=new Date(t);i.setFirstDayOfThisWeek(e.firstDayOfWeek);for(var l=0;7>l;l++){var d=$("<span>").addClass("calDayHeader").attr("day",i.getDay());d.css("width",s),d.html(Date.dayAbbreviations[i.getDay()]),"function"==typeof e.dayHeaderRenderer&&e.dayHeaderRenderer(d,i.getDay()),r.append(d),i.setDate(i.getDate()+1)}i=new Date(t),i.setDate(1),i.setFirstDayOfThisWeek(e.firstDayOfWeek);for(var l=0;i.getMonth()<=t.getMonth()&&i.getFullYear()<=t.getFullYear()||i.getFullYear()<t.getFullYear()||l%7!=0;){var d=$("<span>").addClass("calElement day").attr("millis",i.getTime());d.html("<span class=dayNumber>"+i.getDate()+"</span>").css("width",s),i.getYear()==a.getYear()&&i.getMonth()==a.getMonth()&&i.getDate()==a.getDate()&&d.addClass("today"),i.getYear()==t.getYear()&&i.getMonth()==t.getMonth()&&i.getDate()==t.getDate()&&d.addClass("selected"),i.getMonth()!=t.getMonth()&&d.addClass("calOutOfScope"),"function"==typeof e.dayRenderer&&e.dayRenderer(d,i),r.append(d),i.setDate(i.getDate()+1),l++}};i(a),l(a)},n.click(function(a){var s=$(a.target).closest(".calElement");if(s.size()>0){var r=new Date(parseInt(s.attr("millis")));s.hasClass("day")?(n.remove(),s.is(".noCallback")||(e.inputField.val(r.format(e.dateFormat)).attr("millis",r.getTime()).focus(),"function"==typeof e.callback&&e.callback(r))):t.drawCalendar(r)}a.stopPropagation()}),$.event.special.mousewheel&&e.useWheel&&r.mousewheel(function(e,a){var n=new Date(t.currentDate.getTime());return n.setMonth(n.getMonth()+a),t.drawCalendar(n),!1});var l=e.inputField.val();if(l&&Date.isValid(l,e.dateFormat,!0)){var d=Date.parseString(l,e.dateFormat,!0);e.isSearchField||e.inputField.val(d.format(e.dateFormat)).attr("millis",d.getTime()),t.drawCalendar(d)}else t.drawCalendar(new Date);return t}};