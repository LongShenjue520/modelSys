function showLoader(){if(document.getElementsByTagName("body").item(0).style.cursor="wait",top.frames["header-frame"]&&top.frames["header-frame"].document.getElementById("load-div"))top.frames["header-frame"].document.getElementById("load-div").style.display="block";else{var e=document.getElementById("loader");e||"undefined"==typeof process_request||(e=document.createElement("DIV"),e.id="loader",e.innerHTML=process_request,document.body.appendChild(e))}}function hideLoader(){if(document.getElementsByTagName("body").item(0).style.cursor="auto",top.frames["header-frame"]&&top.frames["header-frame"].document.getElementById("load-div"))setTimeout(function(){top.frames["header-frame"].document.getElementById("load-div").style.display="none"},10);else try{var e=document.getElementById("loader");e.style.display="none",document.body.removeChild(e)}catch(t){}}var Transport={filename:"transport.js",debugging:{isDebugging:0,debuggingMode:0,linefeed:"",containerId:0},debug:function(e,t){this.debugging={isDebugging:e,debuggingMode:t,linefeed:t?"<br />":"\n",containerId:"dubugging-container"+(new Date).getTime()}},onComplete:function(){},onRunning:function(){},run:function(e,t,n,r,o,i,a){if(t=this.parseParams(t),r="string"==typeof r&&"GET"===r.toUpperCase()?"GET":"POST","GET"===r){var s=new Date;e+=t?(-1===e.indexOf("?")?"?":"&")+t:"",e=encodeURI(e)+(-1===e.indexOf("?")?"?":"&")+s.getTime()+s.getMilliseconds(),t=null}o="string"!=typeof o||"JSON"!==(o=o.toUpperCase())&&"XML"!==o?"TEXT":o,i=i===!1?!1:!0;var u=this.createXMLHttpRequest();try{var d=this;if("function"!=typeof d.onRunning||a||d.onRunning(),u.open(r,e,i),"POST"===r&&u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),!i){"function"==typeof d.onRunning&&d.onRunning(),u.send(t);var l=d.parseResult(o,u);return"function"==typeof d.onComplete&&d.onComplete(),"function"==typeof n&&n.call(d,l,u.responseText),l}u.onreadystatechange=function(){if(4==u.readyState){switch(u.status){case 0:case 200:"function"==typeof d.onComplete&&d.onComplete(),"function"==typeof n&&n.call(d,d.parseResult(o,u),u.responseText);break;case 304:break;case 400:alert("XmlHttpRequest status: [400] Bad Request");break;case 404:alert("XmlHttpRequest status: [404] \nThe requested URL "+e+" was not found on this server.");break;case 409:break;case 503:alert("XmlHttpRequest status: [503] Service Unavailable");break;default:alert("XmlHttpRequest status: ["+u.status+"] Unknow status.")}u=null}},null!=u&&u.send(t)}catch(c){"function"==typeof d.onComplete&&d.onComplete(),alert(this.filename+"/run() error:"+c.description)}},displayDebuggingInfo:function(e,t){if(this.debugging.debuggingMode){var n=this.debugging.containerId;if(!document.getElementById(n)){div=document.createElement("DIV"),div.id=n,div.style.position="absolute",div.style.width="98%",div.style.border="1px solid #f00",div.style.backgroundColor="#eef";var r=document.body.scrollTop||window.pageYOffset||0;div.style.top=.6*document.body.clientHeight+r+"px",document.body.appendChild(div),div.innerHTML="<div></div><hr style='height:1px;border:1px dashed red;'><div></div>"}var o=div.getElementsByTagName("DIV");"param"===t?o[0].innerHTML=e:o[1].innerHTML=e}else alert(e)},createXMLHttpRequest:function(){var e=null;if(window.ActiveXObject)for(var t=["Microsoft.XMLHTTP","MSXML6.XMLHTTP","MSXML5.XMLHTTP","MSXML4.XMLHTTP","MSXML3.XMLHTTP","MSXML2.XMLHTTP","MSXML.XMLHTTP"],n=0;n<t.length;n++)try{e=new ActiveXObject(t[n]);break}catch(r){continue}else e=new XMLHttpRequest;return e},onXMLHttpRequestError:function(e,t){throw"URL: "+t+"\nreadyState: "+e.readyState+"\nstate: "+e.status+"\nheaders: "+e.getAllResponseHeaders()},parseParams:function(e){var t="";if(e=e?e:"","string"==typeof e)t=e;else{if("object"!=typeof e)return alert("Invalid parameters!"),!1;try{t="JSON="+e.toJSONString()}catch(n){return alert("Can't stringify JSON!"),!1}}if(this.debugging.isDebugging){var r=this.debugging.linefeed,o="[Original Parameters]"+r+e+r+r+"[Parsed Parameters]"+r+t;this.displayDebuggingInfo(o,"param")}return t},preFilter:function(e){return e.replace(/\xEF\xBB\xBF/g,"")},parseResult:function(e,t){var n=null;switch(e){case"JSON":n=this.preFilter(t.responseText);try{n=n.parseJSON()}catch(r){throw this.filename+"/parseResult() error: can't parse to JSON.\n\n"+t.responseText}break;case"XML":n=t.responseXML;break;case"TEXT":n=this.preFilter(t.responseText);break;default:throw this.filename+"/parseResult() error: unknown response type:"+e}if(this.debugging.isDebugging){var o=this.debugging.linefeed,i="[Response Result of "+e+" Format]"+o+n;"JSON"===e&&(i="[Response Result of TEXT Format]"+o+t.responseText+o+o+i),this.displayDebuggingInfo(i,"result")}return n}},Ajax=Transport;Ajax.call=Transport.run,Object.prototype.toJSONString||(Array.prototype.toJSONString=function(){function e(e){t&&o.push(","),o.push(e),t=!0}var t,n,r,o=["["],i=this.length;for(n=0;i>n;n++)switch(r=this[n],typeof r){case"undefined":case"function":case"unknown":break;case"object":r?"function"==typeof r.toJSONString&&e(r.toJSONString()):e("null");break;default:e(r.toJSONString())}return o.push("]"),o.join("")},Boolean.prototype.toJSONString=function(){return String(this)},Date.prototype.toJSONString=function(){function e(e){return 10>e?"0"+e:e}return'"'+this.getFullYear()+"-"+e(this.getMonth()+1)+"-"+e(this.getDate())+"T"+e(this.getHours())+":"+e(this.getMinutes())+":"+e(this.getSeconds())+'"'},Number.prototype.toJSONString=function(){return isFinite(this)?String(this):"null"},Object.prototype.toJSONString=function(){function e(e){t&&o.push(","),o.push(n.toJSONString(),":",e),t=!0}var t,n,r,o=["{"];for(n in this)if(this.hasOwnProperty(n))switch(r=this[n],typeof r){case"undefined":case"function":case"unknown":break;case"object":this!==window&&(r?"function"==typeof r.toJSONString&&e(r.toJSONString()):e("null"));break;default:e(r.toJSONString())}return o.push("}"),o.join("")},function(s){var m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};s.parseJSON=function(filter){function walk(e,t){if(t&&"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&(t[n]=walk(n,t[n]));return filter(e,t)}try{if(/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/.test(this)){var j=eval("("+this+")");return"function"==typeof filter&&(j=walk("",j)),j}}catch(e){}throw new SyntaxError("parseJSON")},s.toJSONString=function(){var e=this.replace("&","%26");return/["\\\x00-\x1f]/.test(this)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,t){var n=m[t];return n?n:(n=t.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})+'"':'"'+e+'"'}}(String.prototype)),Ajax.onRunning=showLoader,Ajax.onComplete=hideLoader;