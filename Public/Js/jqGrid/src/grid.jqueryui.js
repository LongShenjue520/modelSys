!function($){if($.browser.msie&&8==$.browser.version&&($.expr[":"].hidden=function(t){return 0===t.offsetWidth||0===t.offsetHeight||"none"==t.style.display}),$.jgrid._multiselect=!1,$.ui&&$.ui.multiselect){if($.ui.multiselect.prototype._setSelected){var setSelected=$.ui.multiselect.prototype._setSelected;$.ui.multiselect.prototype._setSelected=function(t,e){var i=setSelected.call(this,t,e);if(e&&this.selectedList){var o=this.element;this.selectedList.find("li").each(function(){$(this).data("optionLink")&&$(this).data("optionLink").remove().appendTo(o)})}return i}}$.ui.multiselect.prototype.destroy&&($.ui.multiselect.prototype.destroy=function(){this.element.show(),this.container.remove(),void 0===$.Widget?$.widget.prototype.destroy.apply(this,arguments):$.Widget.prototype.destroy.apply(this,arguments)}),$.jgrid._multiselect=!0}$.jgrid.extend({sortableColumns:function(t){return this.each(function(){function e(){i.p.disableClick=!0}var i=this,o=$.jgrid.jqID(i.p.id),r={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+o+"_cb,#jqgh_"+o+"_rn,#jqgh_"+o+"_subgrid),:hidden)",placeholder:{element:function(t){var e=$(document.createElement(t[0].nodeName)).addClass(t[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0];return e},update:function(t,e){e.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),e.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}},update:function(t,e){var o=$(e.item).parent(),r=$(">th",o),s=i.p.colModel,n={},a=i.p.id+"_";$.each(s,function(t){n[this.name]=t});var d=[];r.each(function(){var t=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(a,"");t in n&&d.push(n[t])}),$(i).jqGrid("remapColumns",d,!0,!0),$.isFunction(i.p.sortable.update)&&i.p.sortable.update(d),setTimeout(function(){i.p.disableClick=!1},50)}};if(i.p.sortable.options?$.extend(r,i.p.sortable.options):$.isFunction(i.p.sortable)&&(i.p.sortable={update:i.p.sortable}),r.start){var s=r.start;r.start=function(t,i){e(),s.call(this,t,i)}}else r.start=e;i.p.sortable.exclude&&(r.items+=":not("+i.p.sortable.exclude+")"),t.sortable(r).data("sortable").floating=!0})},columnChooser:function(t){function e(t,e,i){if(e>=0){var o=t.slice(),r=o.splice(e,Math.max(t.length-e,e));return e>t.length&&(e=t.length),o[e]=i,o.concat(r)}}function i(t,e){t&&("string"==typeof t?$.fn[t]&&$.fn[t].apply(e,$.makeArray(arguments).slice(2)):$.isFunction(t)&&t.apply(e,$.makeArray(arguments).slice(2)))}var o=this;if(!$("#colchooser_"+$.jgrid.jqID(o[0].p.id)).length){var r=$('<div id="colchooser_'+o[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),s=$("select",r);if(t=$.extend({width:420,height:240,classname:null,done:function(t){t&&o.jqGrid("remapColumns",t,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470},dlog_opts:function(t){var e={};return e[t.bSubmit]=function(){t.apply_perm(),t.cleanup(!1)},e[t.bCancel]=function(){t.cleanup(!0)},$.extend(!0,{buttons:e,close:function(){t.cleanup(!0)},modal:t.modal?t.modal:!1,resizable:t.resizable?t.resizable:!0,width:t.width+20},t.dialog_opts||{})},apply_perm:function(){$("option",s).each(function(){this.selected?o.jqGrid("showCol",n[this.value].name):o.jqGrid("hideCol",n[this.value].name)});var i=[];$("option:selected",s).each(function(){i.push(parseInt(this.value,10))}),$.each(i,function(){delete d[n[parseInt(this,10)].name]}),$.each(d,function(){var t=parseInt(this,10);i=e(i,t,t)}),t.done&&t.done.call(o,i)},cleanup:function(e){i(t.dlog,r,"destroy"),i(t.msel,s,"destroy"),r.remove(),e&&t.done&&t.done.call(o)},msel_opts:{}},$.jgrid.col,t||{}),$.ui&&$.ui.multiselect&&"multiselect"==t.msel){if(!$.jgrid._multiselect)return void alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");t.msel_opts=$.extend($.ui.multiselect.defaults,t.msel_opts)}t.caption&&r.attr("title",t.caption),t.classname&&(r.addClass(t.classname),s.addClass(t.classname)),t.width&&($(">div",r).css({width:t.width,margin:"0 auto"}),s.css("width",t.width)),t.height&&($(">div",r).css("height",t.height),s.css("height",t.height-10));var n=o.jqGrid("getGridParam","colModel"),a=o.jqGrid("getGridParam","colNames"),d={},l=[];s.empty(),$.each(n,function(t){return d[this.name]=t,this.hidedlg?void(this.hidden||l.push(t)):void s.append("<option value='"+t+"' "+(this.hidden?"":"selected='selected'")+">"+a[t]+"</option>")});var p=$.isFunction(t.dlog_opts)?t.dlog_opts.call(o,t):t.dlog_opts;i(t.dlog,r,p);var c=$.isFunction(t.msel_opts)?t.msel_opts.call(o,t):t.msel_opts;i(t.msel,s,c)}},sortableRows:function(t){return this.each(function(){var e=this;e.grid&&(e.p.treeGrid||$.fn.sortable&&(t=$.extend({cursor:"move",axis:"y",items:".jqgrow"},t||{}),t.start&&$.isFunction(t.start)?(t._start_=t.start,delete t.start):t._start_=!1,t.update&&$.isFunction(t.update)?(t._update_=t.update,delete t.update):t._update_=!1,t.start=function(i,o){if($(o.item).css("border-width","0px"),$("td",o.item).each(function(t){this.style.width=e.grid.cols[t].style.width}),e.p.subGrid){var r=$(o.item).attr("id");try{$(e).jqGrid("collapseSubGridRow",r)}catch(s){}}t._start_&&t._start_.apply(this,[i,o])},t.update=function(i,o){$(o.item).css("border-width",""),e.p.rownumbers===!0&&$("td.jqgrid-rownum",e.rows).each(function(t){$(this).html(t+1+(parseInt(e.p.page,10)-1)*parseInt(e.p.rowNum,10))}),t._update_&&t._update_.apply(this,[i,o])},$("tbody:first",e).sortable(t),$("tbody:first",e).disableSelection()))})},gridDnD:function(t){return this.each(function(){function e(){var t=$.data(i,"dnd");$("tr.jqgrow:not(.ui-draggable)",i).draggable($.isFunction(t.drag)?t.drag.call($(i),t):t.drag)}var i=this;if(i.grid&&!i.p.treeGrid&&$.fn.draggable&&$.fn.droppable){var o="<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>";if(null===$("#jqgrid_dnd").html()&&$("body").append(o),"string"==typeof t&&"updateDnD"==t&&i.p.jqgdnd===!0)return void e();if(t=$.extend({drag:function(t){return $.extend({start:function(e,o){if(i.p.subGrid){var r=$(o.helper).attr("id");try{$(i).jqGrid("collapseSubGridRow",r)}catch(s){}}for(var n=0;n<$.data(i,"dnd").connectWith.length;n++)"0"==$($.data(i,"dnd").connectWith[n]).jqGrid("getGridParam","reccount")&&$($.data(i,"dnd").connectWith[n]).jqGrid("addRowData","jqg_empty_row",{});o.helper.addClass("ui-state-highlight"),$("td",o.helper).each(function(t){this.style.width=i.grid.headers[t].width+"px"}),t.onstart&&$.isFunction(t.onstart)&&t.onstart.call($(i),e,o)},stop:function(e,o){if(o.helper.dropped&&!t.dragcopy){var r=$(o.helper).attr("id");void 0===r&&(r=$(this).attr("id")),$(i).jqGrid("delRowData",r)}for(var s=0;s<$.data(i,"dnd").connectWith.length;s++)$($.data(i,"dnd").connectWith[s]).jqGrid("delRowData","jqg_empty_row");t.onstop&&$.isFunction(t.onstop)&&t.onstop.call($(i),e,o)}},t.drag_opts||{})},drop:function(t){return $.extend({accept:function(t){if(!$(t).hasClass("jqgrow"))return t;var e=$(t).closest("table.ui-jqgrid-btable");if(e.length>0&&void 0!==$.data(e[0],"dnd")){var i=$.data(e[0],"dnd").connectWith;return-1!=$.inArray("#"+$.jgrid.jqID(this.id),i)?!0:!1}return!1},drop:function(e,o){if($(o.draggable).hasClass("jqgrow")){var r=$(o.draggable).attr("id"),s=o.draggable.parent().parent().jqGrid("getRowData",r);if(!t.dropbyname){var n,a=0,d={},l=$("#"+$.jgrid.jqID(this.id)).jqGrid("getGridParam","colModel");try{for(var p in s)n=l[a].name,"cb"!=n&&"rn"!=n&&"subgrid"!=n&&s.hasOwnProperty(p)&&l[a]&&(d[n]=s[p]),a++;s=d}catch(c){}}if(o.helper.dropped=!0,t.beforedrop&&$.isFunction(t.beforedrop)){var u=t.beforedrop.call(this,e,o,s,$("#"+$.jgrid.jqID(i.p.id)),$(this));"undefined"!=typeof u&&null!==u&&"object"==typeof u&&(s=u)}if(o.helper.dropped){var h;t.autoid&&($.isFunction(t.autoid)?h=t.autoid.call(this,s):(h=Math.ceil(1e3*Math.random()),h=t.autoidprefix+h)),$("#"+$.jgrid.jqID(this.id)).jqGrid("addRowData",h,s,t.droppos)}t.ondrop&&$.isFunction(t.ondrop)&&t.ondrop.call(this,e,o,s)}}},t.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},t||{}),t.connectWith){t.connectWith=t.connectWith.split(","),t.connectWith=$.map(t.connectWith,function(t){return $.trim(t)}),$.data(i,"dnd",t),"0"==i.p.reccount||i.p.jqgdnd||e(),i.p.jqgdnd=!0;for(var r=0;r<t.connectWith.length;r++){var s=t.connectWith[r];$(s).droppable($.isFunction(t.drop)?t.drop.call($(i),t):t.drop)}}}})},gridResize:function(opts){return this.each(function(){var $t=this,gID=$.jgrid.jqID($t.p.id);if($t.grid&&$.fn.resizable){if(opts=$.extend({},opts||{}),opts.alsoResize?(opts._alsoResize_=opts.alsoResize,delete opts.alsoResize):opts._alsoResize_=!1,opts.stop&&$.isFunction(opts.stop)?(opts._stop_=opts.stop,delete opts.stop):opts._stop_=!1,opts.stop=function(t,e){$($t).jqGrid("setGridParam",{height:$("#gview_"+gID+" .ui-jqgrid-bdiv").height()}),$($t).jqGrid("setGridWidth",e.size.width,opts.shrinkToFit),opts._stop_&&opts._stop_.call($t,t,e)},opts._alsoResize_){var optstest="{'#gview_"+gID+" .ui-jqgrid-bdiv':true,'"+opts._alsoResize_+"':true}";opts.alsoResize=eval("("+optstest+")")}else opts.alsoResize=$(".ui-jqgrid-bdiv","#gview_"+gID);delete opts._alsoResize_,$("#gbox_"+gID).resizable(opts)}})}})}(jQuery);