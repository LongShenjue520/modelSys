!function(e){"use strict";e.jgrid.extend({getColProp:function(e){var t={},i=this[0];if(!i.grid)return!1;for(var r=i.p.colModel,a=0;a<r.length;a++)if(r[a].name==e){t=r[a];break}return t},setColProp:function(t,i){return this.each(function(){if(this.grid&&i)for(var r=this.p.colModel,a=0;a<r.length;a++)if(r[a].name==t){e.extend(this.p.colModel[a],i);break}})},sortGrid:function(e,t,i){return this.each(function(){var r=this,a=-1;if(r.grid){e||(e=r.p.sortname);for(var s=0;s<r.p.colModel.length;s++)if(r.p.colModel[s].index==e||r.p.colModel[s].name==e){a=s;break}if(-1!=a){var o=r.p.colModel[a].sortable;"boolean"!=typeof o&&(o=!0),"boolean"!=typeof t&&(t=!1),o&&r.sortData("jqgh_"+r.p.id+"_"+e,a,t,i)}}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&e(this.p.pager).remove();try{e("#gbox_"+e.jgrid.jqID(this.id)).remove()}catch(t){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var t={id:e(this).attr("id"),cl:e(this).attr("class")};this.p.pager&&e(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");var i=document.createElement("table");e(i).attr({id:t.id}),i.className=t.cl;var r=e.jgrid.jqID(this.id);e(i).removeClass("ui-jqgrid-btable"),1===e(this.p.pager).parents("#gbox_"+r).length?(e(i).insertBefore("#gbox_"+r).show(),e(this.p.pager).insertBefore("#gbox_"+r)):e(i).insertBefore("#gbox_"+r).show(),e("#gbox_"+r).remove()}})},setGridState:function(t){return this.each(function(){if(this.grid){var i=this;"hidden"==t?(e(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+e.jgrid.jqID(i.p.id)).slideUp("fast"),i.p.pager&&e(i.p.pager).slideUp("fast"),i.p.toppager&&e(i.p.toppager).slideUp("fast"),i.p.toolbar[0]===!0&&("both"==i.p.toolbar[1]&&e(i.grid.ubDiv).slideUp("fast"),e(i.grid.uDiv).slideUp("fast")),i.p.footerrow&&e(".ui-jqgrid-sdiv","#gbox_"+e.jgrid.jqID(i.p.id)).slideUp("fast"),e(".ui-jqgrid-titlebar-close span",i.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),i.p.gridstate="hidden"):"visible"==t&&(e(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+e.jgrid.jqID(i.p.id)).slideDown("fast"),i.p.pager&&e(i.p.pager).slideDown("fast"),i.p.toppager&&e(i.p.toppager).slideDown("fast"),i.p.toolbar[0]===!0&&("both"==i.p.toolbar[1]&&e(i.grid.ubDiv).slideDown("fast"),e(i.grid.uDiv).slideDown("fast")),i.p.footerrow&&e(".ui-jqgrid-sdiv","#gbox_"+e.jgrid.jqID(i.p.id)).slideDown("fast"),e(".ui-jqgrid-titlebar-close span",i.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),i.p.gridstate="visible")}})},filterToolbar:function(t){return t=e.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},t||{}),this.each(function(){function i(t,i){var r=e(t);r[0]&&jQuery.each(i,function(){void 0!==this.data?r.bind(this.type,this.data,this.fn):r.bind(this.type,this.fn)})}var r=this;if(!this.ftoolbar){var a,s=function(){var i,a,s,o={},d=0,n={};e.each(r.p.colModel,function(){if(a=this.index||this.name,s=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"==this.stype?"eq":t.defaultSearch,i=e("#gs_"+e.jgrid.jqID(this.name),this.frozen===!0&&r.p.frozenColumns===!0?r.grid.fhDiv:r.grid.hDiv).val())o[a]=i,n[a]=s,d++;else try{delete r.p.postData[a]}catch(l){}});var l=d>0?!0:!1;if(t.stringResult===!0||"local"==r.p.datatype){var h='{"groupOp":"'+t.groupOp+'","rules":[',p=0;e.each(o,function(e,t){p>0&&(h+=","),h+='{"field":"'+e+'",',h+='"op":"'+n[e]+'",',t+="",h+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',p++}),h+="]}",e.extend(r.p.postData,{filters:h}),e.each(["searchField","searchString","searchOper"],function(e,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]})}else e.extend(r.p.postData,o);var u;r.p.searchurl&&(u=r.p.url,e(r).jqGrid("setGridParam",{url:r.p.searchurl}));var c="stop"===e(r).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!c&&e.isFunction(t.beforeSearch)&&(c=t.beforeSearch.call(r)),c||e(r).jqGrid("setGridParam",{search:l}).trigger("reloadGrid",[{page:1}]),u&&e(r).jqGrid("setGridParam",{url:u}),e(r).triggerHandler("jqGridToolbarAfterSearch"),e.isFunction(t.afterSearch)&&t.afterSearch.call(r)},o=function(i){var a,s={},o=0;i="boolean"!=typeof i?!0:i,e.each(r.p.colModel,function(){var t;switch(this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(t=this.searchoptions.defaultValue),a=this.index||this.name,this.stype){case"select":if(e("#gs_"+e.jgrid.jqID(this.name)+" option",this.frozen===!0&&r.p.frozenColumns===!0?r.grid.fhDiv:r.grid.hDiv).each(function(i){return 0===i&&(this.selected=!0),e(this).val()==t?(this.selected=!0,!1):void 0}),void 0!==t)s[a]=t,o++;else try{delete r.p.postData[a]}catch(i){}break;case"text":if(e("#gs_"+e.jgrid.jqID(this.name),this.frozen===!0&&r.p.frozenColumns===!0?r.grid.fhDiv:r.grid.hDiv).val(t),void 0!==t)s[a]=t,o++;else try{delete r.p.postData[a]}catch(d){}}});var d=o>0?!0:!1;if(t.stringResult===!0||"local"==r.p.datatype){var n='{"groupOp":"'+t.groupOp+'","rules":[',l=0;e.each(s,function(e,t){l>0&&(n+=","),n+='{"field":"'+e+'",',n+='"op":"eq",',t+="",n+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',l++}),n+="]}",e.extend(r.p.postData,{filters:n}),e.each(["searchField","searchString","searchOper"],function(e,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]})}else e.extend(r.p.postData,s);var h;r.p.searchurl&&(h=r.p.url,e(r).jqGrid("setGridParam",{url:r.p.searchurl}));var p="stop"===e(r).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!p&&e.isFunction(t.beforeClear)&&(p=t.beforeClear.call(r)),p||i&&e(r).jqGrid("setGridParam",{search:d}).trigger("reloadGrid",[{page:1}]),h&&e(r).jqGrid("setGridParam",{url:h}),e(r).triggerHandler("jqGridToolbarAfterClear"),e.isFunction(t.afterClear)&&t.afterClear()},d=function(){var t=e("tr.ui-search-toolbar",r.grid.hDiv),i=r.p.frozenColumns===!0?e("tr.ui-search-toolbar",r.grid.fhDiv):!1;"none"==t.css("display")?(t.show(),i&&i.show()):(t.hide(),i&&i.hide())},n=e("<tr class='ui-search-toolbar' role='rowheader'></tr>");e.each(r.p.colModel,function(){var o,d,l,h,p,u=this;if(d=e("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+r.p.direction+"'></th>"),o=e("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>"),this.hidden===!0&&e(d).css("display","none"),this.search=this.search===!1?!1:!0,"undefined"==typeof this.stype&&(this.stype="text"),l=e.extend({},this.searchoptions||{}),this.search)switch(this.stype){case"select":if(h=this.surl||l.dataUrl)p=o,e.ajax(e.extend({url:h,dataType:"html",success:function(r){if(void 0!==l.buildSelect){var a=l.buildSelect(r);a&&e(p).append(a)}else e(p).append(r);void 0!==l.defaultValue&&e("select",p).val(l.defaultValue),e("select",p).attr({name:u.index||u.name,id:"gs_"+u.name}),l.attr&&e("select",p).attr(l.attr),e("select",p).css({width:"100%"}),void 0!==l.dataInit&&l.dataInit(e("select",p)[0]),void 0!==l.dataEvents&&i(e("select",p)[0],l.dataEvents),t.autosearch===!0&&e("select",p).change(function(){return s(),!1}),r=null}},e.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));else{var c,g,f;if(u.searchoptions?(c=void 0===u.searchoptions.value?"":u.searchoptions.value,g=void 0===u.searchoptions.separator?":":u.searchoptions.separator,f=void 0===u.searchoptions.delimiter?";":u.searchoptions.delimiter):u.editoptions&&(c=void 0===u.editoptions.value?"":u.editoptions.value,g=void 0===u.editoptions.separator?":":u.editoptions.separator,f=void 0===u.editoptions.delimiter?";":u.editoptions.delimiter),c){var v=document.createElement("select");v.style.width="100%",e(v).attr({name:u.index||u.name,id:"gs_"+u.name});var j,b,m;if("string"==typeof c){j=c.split(f);for(var q=0;q<j.length;q++)b=j[q].split(g),m=document.createElement("option"),m.value=b[0],m.innerHTML=b[1],v.appendChild(m)}else if("object"==typeof c)for(var D in c)c.hasOwnProperty(D)&&(m=document.createElement("option"),m.value=D,m.innerHTML=c[D],v.appendChild(m));void 0!==l.defaultValue&&e(v).val(l.defaultValue),l.attr&&e(v).attr(l.attr),void 0!==l.dataInit&&l.dataInit(v),void 0!==l.dataEvents&&i(v,l.dataEvents),e(o).append(v),t.autosearch===!0&&e(v).change(function(){return s(),!1})}}break;case"text":var w=void 0!==l.defaultValue?l.defaultValue:"";e(o).append("<input type='text' style='width:95%;padding:0px;' name='"+(u.index||u.name)+"' id='gs_"+u.name+"' value='"+w+"'/>"),l.attr&&e("input",o).attr(l.attr),void 0!==l.dataInit&&l.dataInit(e("input",o)[0]),void 0!==l.dataEvents&&i(e("input",o)[0],l.dataEvents),t.autosearch===!0&&(t.searchOnEnter?e("input",o).keypress(function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0;return 13==t?(s(),!1):this}):e("input",o).keydown(function(e){var t=e.which;switch(t){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:a&&clearTimeout(a),a=setTimeout(function(){s()},500)}}))}e(d).append(o),e(n).append(d)}),e("table thead",r.grid.hDiv).append(n),this.ftoolbar=!0,this.triggerToolbar=s,this.clearToolbar=o,this.toggleToolbar=d}})},destroyGroupHeader:function(t){return"undefined"==typeof t&&(t=!0),this.each(function(){var i,r,a,s,o,d,n,l=this,h=l.grid,p=e("table.ui-jqgrid-htable thead",h.hDiv),u=l.p.colModel;if(h){for(e(this).unbind(".setGroupHeaders"),i=e("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels"),s=h.headers,r=0,a=s.length;a>r;r++){n=u[r].hidden?"none":"",o=e(s[r].el).width(s[r].width).css("display",n);try{o.removeAttr("rowSpan")}catch(c){o.attr("rowSpan",1)}i.append(o),d=o.children("span.ui-jqgrid-resize"),d.length>0&&(d[0].style.height=""),o.children("div")[0].style.top=""}e(p).children("tr.ui-jqgrid-labels").remove(),e(p).prepend(i),t===!0&&e(l).jqGrid("setGridParam",{groupHeader:null})}})},setGroupHeaders:function(t){return t=e.extend({useColSpanStyle:!1,groupHeaders:[]},t||{}),this.each(function(){this.p.groupHeader=t;var i,r,a,s,o,d,n,l,h,p,u,c,g,f=this,v=0,j=f.p.colModel,b=j.length,m=f.grid.headers,q=e("table.ui-jqgrid-htable",f.grid.hDiv),D=q.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header"),w=q.children("thead"),C=q.find(".jqg-first-row-header");null===C.html()?C=e("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):C.empty();var y,x=function(e,t){for(var i=0,r=t.length;r>i;i++)if(t[i].startColumnName===e)return i;return-1};for(e(f).prepend(w),a=e("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-third-row-header"),i=0;b>i;i++)if(o=m[i].el,d=e(o),r=j[i],n={height:"0px",width:m[i].width+"px",display:r.hidden?"none":""},e("<th>",{role:"gridcell"}).css(n).addClass("ui-first-th-"+f.p.direction).appendTo(C),o.style.width="",l=x(r.name,t.groupHeaders),l>=0){for(h=t.groupHeaders[l],p=h.numberOfColumns,u=h.titleText,c=0,l=0;p>l&&b>i+l;l++)j[i+l].hidden||c++;s=e("<th>").attr({role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+f.p.direction).css({height:"22px","border-top":"0px none"}).html(u),c>0&&s.attr("colspan",String(c)),f.p.headertitles&&s.attr("title",s.text()),0===c&&s.hide(),d.before(s),a.append(o),v=p-1}else 0===v?t.useColSpanStyle?d.attr("rowspan","2"):(e("<th>",{role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+f.p.direction).css({display:r.hidden?"none":"","border-top":"0px none"}).insertBefore(d),a.append(o)):(a.append(o),v--);g=e(f).children("thead"),g.prepend(C),a.insertAfter(D),q.append(g),t.useColSpanStyle&&(q.find("span.ui-jqgrid-resize").each(function(){var t=e(this).parent();t.is(":visible")&&(this.style.cssText="height: "+t.height()+"px !important; cursor: col-resize;")}),q.find("div.ui-jqgrid-sortable").each(function(){var t=e(this),i=t.parent();i.is(":visible")&&i.is(":has(span.ui-jqgrid-resize)")&&t.css("top",(i.height()-t.outerHeight())/2+"px")})),y=g.find("tr.jqg-first-row-header"),e(f).bind("jqGridResizeStop.setGroupHeaders",function(e,t,i){y.find("th").eq(i).width(t)})})},setFrozenColumns:function(){return this.each(function(){if(this.grid){var t=this,i=t.p.colModel,r=0,a=i.length,s=-1,o=!1;if(!(t.p.subGrid===!0||t.p.treeGrid===!0||t.p.cellEdit===!0||t.p.sortable||t.p.scroll||t.p.grouping)){for(t.p.rownumbers&&r++,t.p.multiselect&&r++;a>r&&i[r].frozen===!0;)o=!0,s=r,r++;if(s>=0&&o){var d=t.p.caption?e(t.grid.cDiv).outerHeight():0,n=e(".ui-jqgrid-htable","#gview_"+e.jgrid.jqID(t.p.id)).height();t.p.toppager&&(d+=e(t.grid.topDiv).outerHeight()),t.p.toolbar[0]===!0&&"bottom"!=t.p.toolbar[1]&&(d+=e(t.grid.uDiv).outerHeight()),t.grid.fhDiv=e('<div style="position:absolute;left:0px;top:'+d+"px;height:"+n+'px;" class="frozen-div ui-state-default ui-jqgrid-hdiv"></div>'),t.grid.fbDiv=e('<div style="position:absolute;left:0px;top:'+(parseInt(d,10)+parseInt(n,10)+1)+'px;overflow-y:hidden" class="frozen-bdiv ui-jqgrid-bdiv"></div>'),e("#gview_"+e.jgrid.jqID(t.p.id)).append(t.grid.fhDiv);var l=e(".ui-jqgrid-htable","#gview_"+e.jgrid.jqID(t.p.id)).clone(!0);if(t.p.groupHeader){e("tr.jqg-first-row-header, tr.jqg-third-row-header",l).each(function(){e("th:gt("+s+")",this).remove()});var h=-1,p=-1;e("tr.jqg-second-row-header th",l).each(function(){var t=parseInt(e(this).attr("colspan"),10);return t&&(h+=t,p++),h===s?!1:void 0}),h!==s&&(p=s),e("tr.jqg-second-row-header",l).each(function(){e("th:gt("+p+")",this).remove()})}else e("tr",l).each(function(){e("th:gt("+s+")",this).remove()});e(l).width(1),e(t.grid.fhDiv).append(l).mousemove(function(e){return t.grid.resizing?(t.grid.dragMove(e),!1):void 0}),e(t).bind("jqGridResizeStop.setFrozenColumns",function(i,r,a){var s=e(".ui-jqgrid-htable",t.grid.fhDiv);e("th:eq("+a+")",s).width(r);var o=e(".ui-jqgrid-btable",t.grid.fbDiv);e("tr:first td:eq("+a+")",o).width(r)}),e(t).bind("jqGridOnSortCol.setFrozenColumns",function(i,r){var a=e("tr.ui-jqgrid-labels:last th:eq("+t.p.lastsort+")",t.grid.fhDiv),s=e("tr.ui-jqgrid-labels:last th:eq("+r+")",t.grid.fhDiv);e("span.ui-grid-ico-sort",a).addClass("ui-state-disabled"),e(a).attr("aria-selected","false"),e("span.ui-icon-"+t.p.sortorder,s).removeClass("ui-state-disabled"),e(s).attr("aria-selected","true"),t.p.viewsortcols[0]||t.p.lastsort!=r&&(e("span.s-ico",a).hide(),e("span.s-ico",s).show())}),e("#gview_"+e.jgrid.jqID(t.p.id)).append(t.grid.fbDiv),jQuery(t.grid.bDiv).scroll(function(){jQuery(t.grid.fbDiv).scrollTop(jQuery(this).scrollTop())}),t.p.hoverrows===!0&&e("#"+e.jgrid.jqID(t.p.id)).unbind("mouseover").unbind("mouseout"),e(t).bind("jqGridAfterGridComplete.setFrozenColumns",function(){e("#"+e.jgrid.jqID(t.p.id)+"_frozen").remove(),jQuery(t.grid.fbDiv).height(jQuery(t.grid.bDiv).height()-16);var i=e("#"+e.jgrid.jqID(t.p.id)).clone(!0);e("tr",i).each(function(){e("td:gt("+s+")",this).remove()}),e(i).width(1).attr("id",t.p.id+"_frozen"),e(t.grid.fbDiv).append(i),t.p.hoverrows===!0&&(e("tr.jqgrow",i).hover(function(){e(this).addClass("ui-state-hover"),e("#"+e.jgrid.jqID(this.id),"#"+e.jgrid.jqID(t.p.id)).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover"),e("#"+e.jgrid.jqID(this.id),"#"+e.jgrid.jqID(t.p.id)).removeClass("ui-state-hover")}),e("tr.jqgrow","#"+e.jgrid.jqID(t.p.id)).hover(function(){e(this).addClass("ui-state-hover"),e("#"+e.jgrid.jqID(this.id),"#"+e.jgrid.jqID(t.p.id)+"_frozen").addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover"),e("#"+e.jgrid.jqID(this.id),"#"+e.jgrid.jqID(t.p.id)+"_frozen").removeClass("ui-state-hover")})),i=null}),t.p.frozenColumns=!0}}}})},destroyFrozenColumns:function(){return this.each(function(){if(this.grid&&this.p.frozenColumns===!0){var t=this;if(e(t.grid.fhDiv).remove(),e(t.grid.fbDiv).remove(),t.grid.fhDiv=null,t.grid.fbDiv=null,e(this).unbind(".setFrozenColumns"),t.p.hoverrows===!0){var i;e("#"+e.jgrid.jqID(t.p.id)).bind("mouseover",function(t){i=e(t.target).closest("tr.jqgrow"),"ui-subgrid"!==e(i).attr("class")&&e(i).addClass("ui-state-hover")}).bind("mouseout",function(t){i=e(t.target).closest("tr.jqgrow"),e(i).removeClass("ui-state-hover")})}this.p.frozenColumns=!1}})}})}(jQuery);