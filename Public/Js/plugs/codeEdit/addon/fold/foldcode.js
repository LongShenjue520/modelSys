!function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)}(function(n){"use strict";function o(o,r,t,i){function f(n){var e=l(o,r);if(!e||e.to.line-e.from.line<d)return null;for(var t=o.findMarksAt(e.from),f=0;f<t.length;++f)if(t[f].__isFold&&"fold"!==i){if(!n)return null;e.cleared=!0,t[f].clear()}return e}var l=t&&(t.call?t:t.rangeFinder);l||(l=n.fold.auto),"number"==typeof r&&(r=n.Pos(r,0));var d=t&&t.minFoldSize||0,u=f(!0);if(t&&t.scanUp)for(;!u&&r.line>o.firstLine();)r=n.Pos(r.line-1,0),u=f(!1);if(u&&!u.cleared&&"unfold"!==i){var a=e(t);n.on(a,"mousedown",function(){c.clear()});var c=o.markText(u.from,u.to,{replacedWith:a,clearOnEnter:!0,__isFold:!0});c.on("clear",function(e,r){n.signal(o,"unfold",o,e,r)}),n.signal(o,"fold",o,u.from,u.to)}}function e(n){var o=n&&n.widget||"â†”";if("string"==typeof o){var e=document.createTextNode(o);o=document.createElement("span"),o.appendChild(e),o.className="CodeMirror-foldmarker"}return o}n.newFoldFunction=function(n,e){return function(r,t){o(r,t,{rangeFinder:n,widget:e})}},n.defineExtension("foldCode",function(n,e,r){o(this,n,e,r)}),n.defineExtension("isFolded",function(n){for(var o=this.findMarksAt(n),e=0;e<o.length;++e)if(o[e].__isFold)return!0}),n.commands.toggleFold=function(n){n.foldCode(n.getCursor())},n.commands.fold=function(n){n.foldCode(n.getCursor(),null,"fold")},n.commands.unfold=function(n){n.foldCode(n.getCursor(),null,"unfold")},n.commands.foldAll=function(o){o.operation(function(){for(var e=o.firstLine(),r=o.lastLine();r>=e;e++)o.foldCode(n.Pos(e,0),null,"fold")})},n.commands.unfoldAll=function(o){o.operation(function(){for(var e=o.firstLine(),r=o.lastLine();r>=e;e++)o.foldCode(n.Pos(e,0),null,"unfold")})},n.registerHelper("fold","combine",function(){var n=Array.prototype.slice.call(arguments,0);return function(o,e){for(var r=0;r<n.length;++r){var t=n[r](o,e);if(t)return t}}}),n.registerHelper("fold","auto",function(n,o){for(var e=n.getHelpers(o,"fold"),r=0;r<e.length;r++){var t=e[r](n,o);if(t)return t}})});