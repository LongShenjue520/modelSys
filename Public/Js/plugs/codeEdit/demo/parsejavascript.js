var JSParser=Editor.Parser=function(){function n(n,t,e,i,r,o){this.indented=n,this.column=t,this.type=e,null!=i&&(this.align=i),this.prev=r,this.info=o}function t(n){return function(t){var e=t&&t.charAt(0),i=n.type,r=e==i;return"vardef"==i?n.indented+4:"form"==i&&"{"==e?n.indented:"stat"==i||"form"==i?n.indented+indentUnit:"switch"!=n.info||r?n.align?n.column-(r?1:0):n.indented+(r?0:indentUnit):n.indented+(/^(?:case|default)\b/.test(t)?indentUnit:2*indentUnit)}}function e(e,o){function a(){for(;K[K.length-1].lex;)K.pop()();var n=I.next();if("whitespace"==n.type&&0==N&&(Q=n.value.length),N+=n.value.length,"\n"==n.content&&(Q=N=0,"align"in M||(M.align=!1),n.indentation=t(M)),"whitespace"==n.type||"comment"==n.type)return n;"align"in M||(M.align=!0);for(;;)if(G=H=!1,K.pop()(n.type,n.content),G)return H?n.style=H:"variable"==n.type&&h(n.content)&&(n.style="js-localvariable"),n}function u(){var n=L,t=M,e=K.concat([]),i=I.state;return function(r){return L=n,M=t,K=e.concat([]),N=Q=0,I=tokenizeJavaScript(r,i),R}}function c(n){for(var t=n.length-1;t>=0;t--)K.push(n[t])}function f(){c(arguments),G=!0}function l(){c(arguments),G=!1}function s(n){H=n}function v(){L={prev:L,vars:{"this":!0,arguments:!0}}}function p(){L=L.prev}function d(n){L&&(s("js-variabledef"),L.vars[n]=!0)}function h(n){for(var t=L;t;){if(t.vars[n])return!0;t=t.prev}return!1}function m(t,e){var i=function(){M=new n(Q,N,t,null,M,e)};return i.lex=!0,i}function y(){")"==M.type&&(Q=M.indented),M=M.prev}function g(n){return function(t){t==n?f():";"==n?l():f(arguments.callee)}}function b(n){return l(k,b)}function w(n){return l(j,w)}function k(n){"var"==n?f(m("vardef"),O,g(";"),y):"keyword a"==n?f(m("form"),j,k,y):"keyword b"==n?f(m("form"),k,y):"{"==n?f(m("}"),z,y):";"==n?f():"function"==n?f(D):"for"==n?f(m("form"),g("("),m(")"),C,g(")"),y,k,y):"variable"==n?f(m("stat"),U):"switch"==n?f(m("form"),j,m("}","switch"),g("{"),z,y,y):"case"==n?f(j,g(":")):"default"==n?f(g(":")):"catch"==n?f(m("form"),v,g("("),F,g(")"),k,y,p):l(m("stat"),j,g(";"),y)}function j(n){i.hasOwnProperty(n)?f(x):"function"==n?f(D):"keyword c"==n?f(j):"("==n?f(m(")"),j,g(")"),y,x):"operator"==n?f(j):"["==n?f(m("]"),S(j,"]"),y,x):"{"==n?f(m("}"),S(J,"}"),y,x):f()}function x(n,t){"operator"==n&&/\+\+|--/.test(t)?f(x):"operator"==n?f(j):";"==n?l():"("==n?f(m(")"),S(j,")"),y,x):"."==n?f(P,x):"["==n&&f(m("]"),j,g("]"),y,x)}function U(n){":"==n?f(y,k):l(x,g(";"),y)}function P(n){"variable"==n&&(s("js-property"),f())}function J(n){"variable"==n&&s("js-property"),i.hasOwnProperty(n)&&f(g(":"),j)}function S(n,t){function e(i){","==i?f(n,e):i==t?f():f(g(t))}return function(i){i==t?f():l(n,e)}}function z(n){"}"==n?f():l(k,z)}function O(n,t){"variable"==n?(d(t),f(A)):f()}function A(n,t){"="==t?f(j,A):","==n&&f(O)}function C(n){"var"==n?f(O,q):";"==n?l(q):"variable"==n?f(E):l(q)}function E(n,t){"in"==t?f(j):f(x,q)}function q(n,t){";"==n?f(B):"in"==t?f(j):f(j,g(";"),B)}function B(n){")"==n?l():f(j)}function D(n,t){"variable"==n?(d(t),f(D)):"("==n&&f(m(")"),v,S(F,")"),y,k,p)}function F(n,t){"variable"==n&&(d(t),f())}var G,H,I=tokenizeJavaScript(e),K=[r?w:b],L=null,M=new n((o||0)-indentUnit,0,"block",!1),N=0,Q=0,R={next:a,copy:u};return y.lex=!0,R}var i={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},r=!1;return{make:e,electricChars:"{}:",configure:function(n){null!=n.json&&(r=n.json)}}}();