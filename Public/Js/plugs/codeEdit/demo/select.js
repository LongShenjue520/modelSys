var select={};!function(){function e(e,t){for(;e&&e.parentNode!=t;)e=e.parentNode;return e}function t(t,n){for(;!t.previousSibling&&t.parentNode!=n;)t=t.parentNode;return e(t.previousSibling,n)}function n(e){var t=e.nextSibling;if(t){for(;t.firstChild;)t=t.firstChild;return 3==t.nodeType||isBR(t)?t:n(t)}for(var o=e.parentNode;o&&!o.nextSibling;)o=o.parentNode;return o&&n(o)}function o(){var e=document.selection;return e?e.createRange?e.createRange():e.createTextRange():null}function r(e){function t(e){for(var t=null;!t&&e;)t=e.nextSibling,e=e.parentNode;return n(t)}function n(e){for(;e&&e.firstChild;)e=e.firstChild;return{node:e,offset:0}}var r=o();r.collapse(e);var i=r.parentElement();if(!isAncestor(document.body,i))return null;if(!i.firstChild)return n(i);var s=r.duplicate();s.moveToElementText(i),s.collapse(!0);for(var l=i.firstChild;l;l=l.nextSibling){if(3==l.nodeType){var a=l.nodeValue.length;s.move("character",a)}else s.moveToElementText(l),s.collapse(!1);var c=r.compareEndPoints("StartToStart",s);if(0==c)return t(l);if(1!=c)return 3!=l.nodeType?n(l):(s.setEndPoint("StartToEnd",r),{node:l,offset:a-s.text.length})}return t(i)}function i(e){var t=o();t&&(t.pasteHTML(e),t.collapse(!1),t.select())}function s(e,t){for(;3!=e.nodeType&&!isBR(e);){var n=e.childNodes[t]||e.nextSibling;for(t=0;!n&&e.parentNode;)e=e.parentNode,n=e.nextSibling;if(e=n,!n)break}return{node:e,offset:t}}function l(e){var t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}function a(){var e=window.getSelection();return e&&0!=e.rangeCount?e.getRangeAt(0):!1}select.ie_selection=!(window.getSelection&&document.createRange&&document.createRange().endContainer);var c="    ";select.scrollToNode=function(e,t){if(e){for(var n=e,o=document.body,r=document.documentElement,i=!n.nextSibling||!n.nextSibling.nextSibling||!n.nextSibling.nextSibling.nextSibling,s=0;n&&!n.offsetTop;)s++,n=n.previousSibling;if(0==s&&(i=!1),!webkit||!n||5!=n.offsetTop||5!=n.offsetLeft){for(var l=s*(n?n.offsetHeight:0),a=0,c=e?e.offsetWidth:0,f=n;f&&f.offsetParent;)l+=f.offsetTop,isBR(f)||(a+=f.offsetLeft),f=f.offsetParent;var d=o.scrollLeft||r.scrollLeft||0,u=o.scrollTop||r.scrollTop||0,v=!1,g=window.innerWidth||r.clientWidth||0;if(t||g>c){if(t){var p=select.offsetInNode(e),m=nodeText(e).length;m&&(a+=c*(p/m))}var T=a-d;(0>T||T>g)&&(d=a,v=!0)}var h=l-u;(0>h||i||h>(window.innerHeight||r.clientHeight||0)-50)&&(u=i?1e6:l,v=!0),v&&window.scrollTo(d,u)}}},select.scrollToCursor=function(e){select.scrollToNode(select.selectionTopNode(e,!0)||e.firstChild,!0)};var f=null;select.snapshotChanged=function(){f&&(f.changed=!0)},select.snapshotReplaceNode=function(e,t,o,r){function i(i){e==i.node?(f.changed=!0,o&&i.offset>o?i.offset-=o:(i.node=t,i.offset+=r||0)):select.ie_selection&&0==i.offset&&i.node==n(e)&&(f.changed=!0)}f&&(i(f.start),i(f.end))},select.snapshotMove=function(e,t,n,o,r){function i(i){e!=i.node||r&&0!=i.offset||(f.changed=!0,i.node=t,o?i.offset=Math.max(0,i.offset+n):i.offset=n)}f&&(i(f.start),i(f.end))},select.ie_selection?(select.markSelection=function(){f=null;var e=document.selection;if(e){var t=r(!0),n=r(!1);t&&n&&(f={start:t,end:n,changed:!1})}},select.selectMarked=function(){function e(e){var t=document.body.createTextRange(),n=e.node;if(n)if(3==n.nodeType){t.moveToElementText(n.parentNode);for(var o=e.offset;n.previousSibling;)n=n.previousSibling,o+=(n.innerText||"").length;t.move("character",o)}else t.moveToElementText(n),t.collapse(!0);else t.moveToElementText(document.body),t.collapse(!1);return t}if(f&&f.changed){var t=e(f.start),n=e(f.end);t.setEndPoint("StartToEnd",n),t.select()}},select.offsetInNode=function(e){var t=o();if(!t)return 0;var n=t.duplicate();try{n.moveToElementText(e)}catch(r){return 0}return t.setEndPoint("StartToStart",n),t.text.length},select.selectionTopNode=function(t,n){function r(e,t){if(3==t.nodeType){for(var n=0,o=t.previousSibling;o&&3==o.nodeType;)n+=o.nodeValue.length,o=o.previousSibling;if(o){try{e.moveToElementText(o)}catch(r){return!1}e.collapse(!1)}else e.moveToElementText(t.parentNode);n&&e.move("character",n)}else try{e.moveToElementText(t)}catch(r){return!1}return!0}var i=o();if(!i)return!1;var s=i.duplicate();i.collapse(n);var l=i.parentElement();if(l&&isAncestor(t,l)&&(s.moveToElementText(l),1==i.compareEndPoints("StartToStart",s)))return e(l,t);for(var n=0,a=t.childNodes.length-1;a>n;){var c=Math.ceil((a+n)/2),f=t.childNodes[c];if(!f)return!1;if(!r(s,f))return!1;1==i.compareEndPoints("StartToStart",s)?n=c:a=c-1}if(0==n){var d=o(),u=d.duplicate();try{u.moveToElementText(t)}catch(v){return null}if(0==d.compareEndPoints("StartToStart",u))return null}return t.childNodes[n]||null},select.focusAfterNode=function(e,t){var n=document.body.createTextRange();n.moveToElementText(e||t),n.collapse(!e),n.select()},select.somethingSelected=function(){var e=o();return e&&""!=e.text},select.insertNewlineAtCursor=function(){i("<br>")},select.insertTabAtCursor=function(){i(c)},select.cursorPos=function(e,t){var n=o();if(!n)return null;for(var r=select.selectionTopNode(e,t);r&&!isBR(r);)r=r.previousSibling;var i=n.duplicate();if(n.collapse(t),r)i.moveToElementText(r),i.collapse(!1);else{try{i.moveToElementText(e)}catch(s){return null}i.collapse(!0)}return n.setEndPoint("StartToStart",i),{node:r,offset:n.text.length}},select.setCursorPos=function(e,t,n){function o(t){var n=document.body.createTextRange();return t.node?(n.moveToElementText(t.node),n.collapse(!1)):(n.moveToElementText(e),n.collapse(!0)),n.move("character",t.offset),n}var r=o(t);n&&n!=t&&r.setEndPoint("EndToEnd",o(n)),r.select()},select.getBookmark=function(e){var t=select.cursorPos(e,!0),n=select.cursorPos(e,!1);return t&&n?{from:t,to:n}:void 0},select.setBookmark=function(e,t){t&&select.setCursorPos(e,t.from,t.to)}):(select.markSelection=function(){var e=window.getSelection();if(!e||0==e.rangeCount)return f=null;var t=e.getRangeAt(0);f={start:s(t.startContainer,t.startOffset),end:s(t.endContainer,t.endOffset),changed:!1}},select.selectMarked=function(){function e(){if(n.start.node==n.end.node&&n.start.offset==n.end.offset){var e=window.getSelection();if(!e||0==e.rangeCount)return!0;var t=e.getRangeAt(0),o=s(t.startContainer,t.startOffset);return n.start.node!=o.node||n.start.offset!=o.offset}}function t(e,t){e.node?0==e.offset?o["set"+t+"Before"](e.node):o["set"+t](e.node,e.offset):o.setStartAfter(document.body.lastChild||document.body)}var n=f;if(n&&(n.changed||webkit&&e())){var o=document.createRange();t(n.end,"End"),t(n.start,"Start"),l(o)}},select.selectionTopNode=function(n,o){var r=a();if(!r)return!1;var i=o?r.startContainer:r.endContainer,s=o?r.startOffset:r.endOffset;return window.opera&&!o&&r.endContainer==n&&r.endOffset==r.startOffset+1&&n.childNodes[r.startOffset]&&isBR(n.childNodes[r.startOffset])&&s--,3==i.nodeType?s>0?e(i,n):t(i,n):"HTML"==i.nodeName.toUpperCase()?1==s?null:n.lastChild:i==n?0==s?null:i.childNodes[s-1]:s==i.childNodes.length?e(i,n):0==s?t(i,n):e(i.childNodes[s-1],n)},select.focusAfterNode=function(e,t){var n=document.createRange();n.setStartBefore(t.firstChild||t),e&&!e.firstChild?n.setEndAfter(e):e?n.setEnd(e,e.childNodes.length):n.setEndBefore(t.firstChild||t),n.collapse(!1),l(n)},select.somethingSelected=function(){var e=a();return e&&!e.collapsed},select.offsetInNode=function(e){var t=a();return t?(t=t.cloneRange(),t.setStartBefore(e),t.toString().length):0},select.insertNodeAtCursor=function(e){var t=a();if(t){if(t.deleteContents(),t.insertNode(e),webkitLastLineHack(document.body),window.opera&&isBR(e)&&isSpan(e.parentNode)){var n=e.nextSibling,o=e.parentNode,r=o.parentNode;r.insertBefore(e,o.nextSibling);for(var i="";n&&3==n.nodeType;n=n.nextSibling)i+=n.nodeValue,removeElement(n);r.insertBefore(makePartSpan(i,document),e.nextSibling)}t=document.createRange(),t.selectNode(e),t.collapse(!1),l(t)}},select.insertNewlineAtCursor=function(){select.insertNodeAtCursor(document.createElement("BR"))},select.insertTabAtCursor=function(){select.insertNodeAtCursor(document.createTextNode(c))},select.cursorPos=function(e,t){var n=a();if(n){for(var o=select.selectionTopNode(e,t);o&&!isBR(o);)o=o.previousSibling;n=n.cloneRange(),n.collapse(t),o?n.setStartAfter(o):n.setStartBefore(e);var r=n.toString();return{node:o,offset:r.length}}},select.setCursorPos=function(e,t,n){function o(t,n,o){function i(e){3==e.nodeType?s.push(e):forEach(e.childNodes,i)}if(0==n&&t&&!t.nextSibling)return r["set"+o+"After"](t),!0;if(t=t?t.nextSibling:e.firstChild){if(0==n)return r["set"+o+"Before"](t),!0;for(var s=[];;){for(;t&&!s.length;)i(t),t=t.nextSibling;var l=s.shift();if(!l)return!1;var a=l.nodeValue.length;if(a>=n)return r["set"+o](l,n),!0;n-=a}}}var r=document.createRange();n=n||t,o(n.node,n.offset,"End")&&o(t.node,t.offset,"Start")&&l(r)})}();