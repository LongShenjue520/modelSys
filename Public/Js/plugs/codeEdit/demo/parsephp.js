Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var t=this.length,e=Number(arguments[1])||0;for(e=0>e?Math.ceil(e):Math.floor(e),0>e&&(e+=t);t>e;e++)if(e in this&&this[e]===n)return e;return-1});var PHPParser=Editor.Parser=function(){function n(n,t,e,i,r,o){this.indented=n,this.column=t,this.type=e,null!=i&&(this.align=i),this.prev=r,this.info=o}function t(n){return function(t){var e=t&&t.charAt(0),i=n.type,r=e==i;return"form"==i&&"{"==e?n.indented:"stat"==i||"form"==i?n.indented+indentUnit:"switch"!=n.info||r?n.align?n.column-(r?1:0):n.indented+(r?0:indentUnit):n.indented+(/^(?:case|default)\b/.test(t)?indentUnit:2*indentUnit)}}function e(e,r){function o(){for(;I[I.length-1].lex;)I.pop()();var n=G.next();if("whitespace"==n.type&&0==K&&(L=n.value.length),K+=n.value.length,"\n"==n.content&&(L=K=0,"align"in J||(J.align=!1),n.indentation=t(J)),"whitespace"==n.type||"comment"==n.type||"string_not_terminated"==n.type)return n;"align"in J||(J.align=!0);for(;;){D=F=!1;var e=I.pop();if(e(n),D)return F&&(n.style=F),n}return 1}function c(){var n=J,t=I.concat([]),e=G.state;return function(i){return J=n,I=t.concat([]),K=L=0,G=tokenizePHP(i,e),Q}}function a(n){for(var t=n.length-1;t>=0;t--)I.push(n[t])}function u(){a(arguments),D=!0}function f(){a(arguments),D=!1}function s(n){F=n}function l(n){F=F+" "+n}function p(t,e){var i=function(){J=new n(L,K,t,null,J,e)};return i.lex=!0,i}function y(){J.prev&&(J=J.prev)}function d(n){return function(t){t.type==n?u():u(arguments.callee)}}function g(n,t){return function(e){var i,r=e.type;i="string"==typeof n?(r==n)-1:n.indexOf(r),i>=0?t&&"function"==typeof t[i]?f(t[i]):u():(F||s(e.style),l("syntax-error"),u(arguments.callee))}}function m(n){return f(h,m)}function h(n){var t=n.type;"keyword a"==t?u(p("form"),v,q,h,y):"keyword b"==t?u(p("form"),q,h,y):"{"==t?u(p("}"),H,y):"function"==t?w():"class"==t?k():"foreach"==t?u(p("form"),g("("),p(")"),v,g("as"),g("variable"),d(")"),q,y,h,y):"for"==t?u(p("form"),g("("),p(")"),v,g(";"),v,g(";"),v,g(")"),q,y,h,y):"modifier"==t?u(g(["modifier","variable","function","abstract"],[null,A(g("variable")),w,U])):"abstract"==t?O():"switch"==t?u(p("form"),g("("),v,g(")"),p("}","switch"),g([":","{"]),H,y,y):"case"==t?u(v,g(":")):"default"==t?u(g(":")):"catch"==t?u(p("form"),g("("),g("t_string"),g("variable"),g(")"),h,y):"const"==t?u(g("t_string")):"namespace"==t?u(j,g(";")):f(p("stat"),v,g(";"),y)}function v(n){var t=n.type;i.hasOwnProperty(t)?u(b):"<<<"==t?u(g("string"),b):"t_string"==t?u(_,b):"keyword c"==t||"operator"==t?u(v):"function"==t?x():"("==t&&u(p(")"),A(v),g(")"),y,b)}function b(n){var t=n.type;"operator"==t?"?"==n.content?u(v,g(":"),v):u(v):"("==t?u(p(")"),v,A(v),g(")"),y,b):"["==t&&u(p("]"),v,g("]"),b,y)}function _(n){"t_double_colon"==n.type?u(g(["t_string","variable"]),b):f(v)}function w(){u(g("t_string"),g("("),p(")"),A(E),g(")"),y,H)}function x(){u(g("("),p(")"),A(E),g(")"),P,y,g("{"),p("}"),H,y)}function P(n){"namespace"==n.type?u(g("("),A(E),g(")")):f(v)}function k(){u(g("t_string"),d("{"),p("}"),H,y)}function U(n){"function"==n.type?w():u(g(["function"],[w]))}function O(n){u(g(["modifier","function","class"],[U,w,k]))}function A(n){function t(e){","==e.type&&u(n,t)}return function(){f(n,t)}}function H(n){"}"==n.type?u():f(h,H)}function z(n){"array"==n.content&&u(g("("),g(")"))}function M(n){"="==n.content&&u(g(["t_string","string","number","atom"],[z,null,null]))}function C(n){"variable"==n.type?u(M):"&"==n.content&&u(g("variable"),M)}function E(n){"t_string"==n.type?u(C):C(n)}function N(n){"t_double_colon"==n.type&&u(j)}function j(n){f(g("t_string"),N)}function q(n){":"==n.content&&u(B,y)}function B(n){"altsyntaxend"==n.type?u(g(";")):f(h,B)}var D,F,G=tokenizePHP(e),I=[m],J=new n((r||0)-indentUnit,0,"block",!1),K=0,L=0,Q={next:o,copy:c};return y.lex=!0,Q}var i={atom:!0,number:!0,variable:!0,string:!0};return{make:e,electricChars:"{}:"}}();