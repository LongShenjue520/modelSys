if("undefined"==typeof FusionCharts)throw alert("FusionChartsExport: object::FusionCharts was not found. Verify script inclusions.",10901271400),"FusionChartsExportComponentFatalError::10901271400";var _FCEO=function(){_FCEO.initializeComponent(this,arguments)},FusionChartsExportObject=_FCEO;FusionCharts.version&&FusionCharts.version[0]>=3&&(_FCEO.__global=FusionCharts(["private","LegacyExportComponent"])),_FCEO.version=[1,0,3,"release",362],_FCEO.defaultParameters={id:void 0,swfLocation:void 0,componentAttributes:{width:"120",height:"40",bgColor:"",strictTrigger:"0"},exportAttributes:{},sourceCharts:[],debugMode:!1,outerHTML:""},_FCEO.checkFlashVersion=!1,_FCEO.debugMode=!1;var FC_ExportComponentReady=function(r){return setTimeout(function(){_FCEO.flushRack(r)},0),!0},FC_ExportDataReady=function(r){setTimeout(function(){return _FCEO.relayStream(r)},0)};_FCEO.prototype.Render=function(r){return this.render(r)},_FCEO.prototype.BeginExport=function(){return _FCEO.batchExport(this,this.sourceCharts)},_FCEO.prototype.BeginExportAll=function(){return _FCEO.batchExport(this,_FCEO.probeCharts())},_FCEO.prototype.GetOuterHTML=function(){return this.update(),this.outerHTML},_FCEO.prototype.render=function(r){var t=_FCEO.L.get(r);if(!t||!_FCEO.L.isObj(t.innerHTML,"string"))return this.trace(_FCEO.R.errContainer,10902091233),!1;this.update();try{this.srcObj.render(t)}catch(e){this.trace(_FCEO.R.errFusion+"\n"+e,10902101448)}return!0},_FCEO.prototype.update=function(){_FCEO.updateComponent(this)},_FCEO.prototype.trace=function(r,t){_FCEO.trace(r,t,this.debugMode)},_FCEO.prototype.toString=function(){return"[object "+_FCEO.R.resSig+" #"+this.id+" ]"},_FCEO.streamRack={},_FCEO.flags={c:0},_FCEO.playerVersion={major:0,minor:0,rev:0};try{"undefined"==typeof _FCEO.__global?_FCEO.playerVersion=infosoftglobal.FusionChartsUtil.getPlayerVersion():_FCEO.playerVersion=_FCEO.__global.swfobject.getFlashPlayerVersion()}catch(err){_FCEO.trace("FusionChartsExport: object::Flash Player DetectionError.\n"+err,10902182119)}_FCEO.relayStream=function(r){var t=_FCEO.probeHandler(r);return null==t&&_FCEO.trace(_FCEO.R.errStream,10902041759),_FCEO.L.isObj(r.parameters.exportParameters)||(r.parameters.exportParameters={}),_FCEO.L.isObj(r.parameters.exportParameters.triggerOrdinal,"number")||(r.parameters.exportParameters.triggerOrdinal=_FCEO.flags.c++),setTimeout(function(){"function"==typeof window.FC_ExportReady&&FC_ExportReady(r.meta.DOMId)},0),_FCEO.probeComponent(t)?(_FCEO.pushStream(t,[r]),!0):(_FCEO.streamRack[t]||(_FCEO.streamRack[t]=[]),_FCEO.streamRack[t].push(r),!0)},_FCEO.flushRack=function(r){r=_FCEO.probeHandler(r),null==r&&_FCEO.trace(_FCEO.R.errComponent,10902041939),_FCEO.probeComponent(r)||_FCEO.trace(_FCEO.R.errComponent,10902041917),_FCEO.streamRack[r]&&(_FCEO.pushStream(r,_FCEO.streamRack[r]),_FCEO.streamRack[r]=[])},_FCEO.pushStream=function(r,t){return _FCEO.L.get(r).pushData(t)},_FCEO.probeComponent=function(r){if(!r)return!1;var t=_FCEO.L.get(r);return t?null!=t.isReady&&1==t.isReady():!1},_FCEO.probeHandler=function(r){return r?_FCEO.L.isString(r)?r:null!=r.parameters&&_FCEO.L.isString(r.parameters.exportHandler)?r.parameters.exportHandler:null:null},_FCEO.probeCharts=function(){var r,t,e=[];t=_FCEO.L.tags("object");for(var n=0;n<t.length;n++)r=t[n],_FCEO.probeChart(r)&&e.push(r);for(t=_FCEO.L.tags("embed"),n=0;n<t.length;n++)r=t[n],(void 0==r.parentNode||"object"!=r.parentNode.tagName)&&_FCEO.probeChart(r)&&e.push(r);return e},_FCEO.probeChart=function(r){if(void 0==r.signature)return!1;var t=r.signature();return _FCEO.L.isString(t)&&0==t.indexOf(_FCEO.R.resChartSig)},_FCEO.initializeComponent=function(r,t){(!t||!t.length||t.length<1)&&_FCEO.trace(_FCEO.R.errArgs,10902061902);var e=!_FCEO.L.isString(t[0])&&1==t.length;!e&&t.length<2&&_FCEO.trace(_FCEO.R.errArgs,10902091732);var n=0;for(var o in _FCEO.defaultParameters)r[o]=(e?t[0][o]:t[n++])||_FCEO.defaultParameters[o];_FCEO.L.isString(r.id)&&_FCEO.L.isString(r.swfLocation)||r.trace(_FCEO.R.errArgs,10902091820),_FCEO.playerVersion.major<10&&(!_FCEO.checkFlashVersion||r.debugMode||_FCEO.debugMode||alert(_FCEO.R.msgNoPlayer),r.trace(_FCEO.R.errPlayer,10902182131)),r.srcObj=new FusionCharts(r.swfLocation,r.id,0,0,r.debugMode)},_FCEO.updateComponent=function(r){r.srcObj||r.trace(_FCEO.R.errFusion,10902220400),_FCEO.L.sync(r.componentAttributes,r.srcObj.variables||r.srcObj.flashVars);var t,e=function(t){return _FCEO.L.isObj((r.srcObj.variables||r.srcObj.flashVars)[t],"undefined")?_FCEO.defaultParameters.componentAttributes[t]:(r.srcObj.variables||r.srcObj.flashVars)[t]};try{(r.srcObj.variables||r.srcObj.flashVars).generator=_FCEO.R.resSig,t=e("width"),void 0!=t&&(_FCEO.__global?(r.srcObj.width=t.toString(),r.srcObj.flashVars.width=t.toString()):(r.srcObj.setAttribute("width",t),r.srcObj.addVariable("width",t))),t=e("height"),void 0!=t&&(_FCEO.__global?(r.srcObj.height=t.toString(),r.srcObj.flashVars.height=t.toString()):(r.srcObj.setAttribute("height",t),r.srcObj.addVariable("height",t))),t=e("bgColor"),void 0!=t&&(r.srcObj.params?r.srcObj.params.bgColor=t:r.srcObj.addParam("bgColor",t)),r.outerHTML=r.srcObj.getSWFHTML()}catch(n){this.trace(_FCEO.R.errFusion+""+n,10902091318)}},_FCEO.batchExport=function(r,t){if(!(t instanceof Array))return r.trace(_FCEO.R.errArgs,10902091853),[];var e=[],n=_FCEO.flags.c;_FCEO.flags.c+=t.length;for(var o=0==parseInt(r.componentAttributes.strictTrigger||0)?function(r){return r}:function(t){return t.handlerId=r.id,t},a=0;a<t.length;a++){var i=_FCEO.L.get(t[a]);null!=i?(_FCEO.L.isObj(r.exportAttributes.exportParameters)||(r.exportAttributes.exportParameters={}),r.exportAttributes.exportParameters.triggerOrdinal=n++,r.exportAttributes=o(r.exportAttributes),i&&i.exportChart?(i.exportChart(r.exportAttributes),e.push(i.id)):r.trace(_FCEO.R.errFusion+"\nRef: "+i.id,10902092036)):r.trace(_FCEO.R.errFusion,10902092026)}return e},_FCEO.toString=function(){return"[object "+_FCEO.R.resSig+"]"},_FCEO.trace=function(r,t,e){(e||_FCEO.debugMode)&&_FCEO.L.raise(r,t)},_FCEO.R={errStream:"Inbound stream missing or stream integrity failure.",errComponent:"Export component missing or authentication failure.",errArgs:"Invalid arguments or parameters out of bounds exception.",errContainer:"Invalid container id or HTMLNode missing from DOM.",errFusion:"Error with internal FusionCharts object. Review parameters.",errPlayer:"Incompatible Flash player or Flash player not installed. Flash Player 10 (or above) is needed for Export Component.",msgNoPlayer:"This page contains elements that require the latest version of Flash Player plugin.",resSig:"FusionChartsExportComponent",resChartSig:"FusionCharts/"},_FCEO.L={isIE:"Microsoft Internet Explorer"==navigator.appName,isFF:document.getElementById&&!document.all,tags:function(r,t){return _FCEO.L.isString(r)?(t||document).getElementsByTagName(r):[]},get:function(r,t){return _FCEO.L.isString(r)?(t||document).getElementById(r):r},getNew:function(r){for(var t,e=document.createElement(r),n=1;c<arguments.length;n++)t=arguments[n].split("="),e.setAttribute(t[0],t[1]);return e},sync:function(r,t){for(var e in r)t[e]=r[e]},isString:function(r){return"string"==typeof r},isObj:function(r,t){return typeof r==(t?t:"object")},raise:function(r,t,e){throw e=e?"# "+e:"",r="[object "+_FCEO.R.resSig+e+"]\n\nError "+t+".\n"+r+"\n\nRefer to documentation.",alert(r),r}};