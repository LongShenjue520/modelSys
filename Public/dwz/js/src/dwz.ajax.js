function validateCallback(a,e){var r=$(a);return r.valid()?($.ajax({type:a.method||"POST",url:r.attr("action"),data:r.serializeArray(),dataType:"json",cache:!1,success:e||DWZ.ajaxDone,error:DWZ.ajaxError}),!1):!1}function iframeCallback(a,e){var r=$(a),t=$("#callbackframe");return r.valid()?(0==t.size()&&(t=$("<iframe id='callbackframe' name='callbackframe' src='about:blank' style='display:none'></iframe>").appendTo("body")),a.ajax||r.append('<input type="hidden" name="ajax" value="1" />'),a.target="callbackframe",void _iframeResponse(t[0],e||DWZ.ajaxDone)):!1}function _iframeResponse(a,e){var r=$(a),t=$(document);t.trigger("ajaxStart"),r.bind("load",function(n){if(r.unbind("load"),t.trigger("ajaxStop"),"javascript:'%3Chtml%3E%3C/html%3E';"!=a.src&&"javascript:'<html></html>';"!=a.src){var o=a.contentDocument||a.document;if(!(o.readyState&&"complete"!=o.readyState||o.body&&"false"==o.body.innerHTML)){var l;if(o.XMLDocument)l=o.XMLDocument;else if(o.body)try{l=r.contents().find("body").html(),l=jQuery.parseJSON(l)}catch(i){l=o.body.innerHTML}else l=o;e(l)}}})}function navTabAjaxDone(a){DWZ.ajaxDone(a),a.statusCode==DWZ.statusCode.ok&&(a.navTabId?navTab.reloadFlag(a.navTabId):navTabPageBreak({},a.rel),"closeCurrent"==a.callbackType?setTimeout(function(){navTab.closeCurrentTab()},100):"forward"==a.callbackType&&navTab.reload(a.forwardUrl))}function dialogAjaxDone(a){DWZ.ajaxDone(a),a.statusCode==DWZ.statusCode.ok&&(a.navTabId?navTab.reload(a.forwardUrl,{navTabId:a.navTabId}):a.rel&&navTabPageBreak({},a.rel),$.pdialog.closeCurrent())}function navTabSearch(a,e){var r=$(a);return a[DWZ.pageInfo.pageNum]&&(a[DWZ.pageInfo.pageNum].value=1),navTab.reload(r.attr("action"),{data:r.serializeArray(),navTabId:e}),!1}function dialogSearch(a){var e=$(a);return a[DWZ.pageInfo.pageNum]&&(a[DWZ.pageInfo.pageNum].value=1),$.pdialog.reload(e.attr("action"),{data:e.serializeArray()}),!1}function dwzSearch(a,e){return"dialog"==e?dialogSearch(a):navTabSearch(a),!1}function divSearch(a,e){var r=$(a);if(a[DWZ.pageInfo.pageNum]&&(a[DWZ.pageInfo.pageNum].value=1),e){var t=$("#"+e);t.ajaxUrl({type:"POST",url:r.attr("action"),data:r.serializeArray(),callback:function(){t.find("[layoutH]").layoutH()}})}return!1}function _getPagerForm(a,e){var r=$("#pagerForm",a).get(0);return r&&(e.pageNum&&(r[DWZ.pageInfo.pageNum].value=e.pageNum),e.numPerPage&&(r[DWZ.pageInfo.numPerPage].value=e.numPerPage),e.orderField&&(r[DWZ.pageInfo.orderField].value=e.orderField),e.orderDirection&&r[DWZ.pageInfo.orderDirection]&&(r[DWZ.pageInfo.orderDirection].value=e.orderDirection)),r}function dwzPageBreak(a){var e=$.extend({targetType:"navTab",rel:"",data:{pageNum:"",numPerPage:"",orderField:"",orderDirection:""},callback:null},a),r="dialog"==e.targetType?$.pdialog.getCurrent():navTab.getCurrentPanel();if(e.rel){var t=r.find("#"+e.rel),n=_getPagerForm(t,e.data);n&&t.ajaxUrl({type:"POST",url:$(n).attr("action"),data:$(n).serializeArray(),callback:function(){t.find("[layoutH]").layoutH()}})}else{var n=_getPagerForm(r,e.data),o=$(n).serializeArray();"dialog"==e.targetType?n&&$.pdialog.reload($(n).attr("action"),{data:o,callback:e.callback}):n&&navTab.reload($(n).attr("action"),{data:o,callback:e.callback})}}function navTabPageBreak(a,e){dwzPageBreak({targetType:"navTab",rel:e,data:a})}function dialogPageBreak(a,e){dwzPageBreak({targetType:"dialog",rel:e,data:a})}function ajaxTodo(url,callback){var $callback=callback||navTabAjaxDone;$.isFunction($callback)||($callback=eval("("+callback+")")),$.ajax({type:"POST",url:url,dataType:"json",cache:!1,success:$callback,error:DWZ.ajaxError})}function uploadifyAllComplete(a,e){if(e.errors){var r="The total number of files uploaded: "+e.filesUploaded+"\nThe total number of errors while uploading: "+e.errors+"\nThe total number of bytes uploaded: "+e.allBytesLoaded+"\nThe average speed of all uploaded files: "+e.speed;alert("event:"+a+"\n"+r)}}function uploadifyComplete(a,e,r,t,n){DWZ.ajaxDone(DWZ.jsonEval(t))}function uploadifyError(a,e,r,t){alert("event:"+a+"\nqueueId:"+e+"\nfileObj.name:"+r.name+"\nerrorObj.type:"+t.type+"\nerrorObj.info:"+t.info)}$.fn.extend({ajaxTodo:function(){return this.each(function(){var a=$(this);a.click(function(e){var r=unescape(a.attr("href")).replaceTmById($(e.target).parents(".unitBox:first"));if(DWZ.debug(r),!r.isFinishedTm())return alertMsg.error(a.attr("warn")||DWZ.msg("alertSelectMsg")),!1;var t=a.attr("title");t?alertMsg.confirm(t,{okCall:function(){ajaxTodo(r,a.attr("callback"))}}):ajaxTodo(r,a.attr("callback")),e.preventDefault()})})},dwzExport:function(){function a(a){var e="dialog"==a.attr("targetType")?$.pdialog.getCurrent():navTab.getCurrentPanel(),r=$("#pagerForm",e),t=a.attr("href");window.location=t+(-1==t.indexOf("?")?"?":"&")+r.serialize()}return this.each(function(){var e=$(this);e.click(function(r){var t=e.attr("title");t?alertMsg.confirm(t,{okCall:function(){a(e)}}):a(e),r.preventDefault()})})}});